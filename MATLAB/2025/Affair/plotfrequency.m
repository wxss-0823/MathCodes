clear;clc;close all;% fid1 = fopen('D:\work\sim_project\sim_ziyan_filter\data\my_s_sin.txt','r');% itemp = fscanf(fid1,'%x\n');% fid2 = fopen('D:\work\sim_project\sim_ziyan_filter\data\my_s_cos.txt','r');% qtemp = fscanf(fid2,'%x\n');% Load datafs =122.88e6;N_width =16;fp = fopen('D:\home\wxss\GitProjects\TempFiles\CaptureData\ddc4_out_n28.txt','r');data = fscanf(fp,'%X %X\n'); % data = fscanf(fp,'%h %h\n'); % data = fscanf(fp,'%d %d\n');fclose(fp);% Mod datadata(data>2^15) = data(data>2^15)-2^16;q0=data(1:2:4095,1); i0=data(2:2:4096,1);i0(i0>2^(N_width-1)) = i0(i0>2^(N_width-1))-2^N_width;q0(q0>2^(N_width-1)) = q0(q0>2^(N_width-1))-2^N_width;% i0=data(1:2:2047,1);% q0=data(2:2:2048,1);% i0=data(2049:2:4001,1);% q0=data(2050:2:4002,1);% % ddc入口% duc出口% q0=data(4097:2:8191,1);% i0=data(4098:2:8192,1);% ddc出口% duc入口% q0=data(4097:2:8191,1);% i0=data(4098:2:8192,1);% i0=data(1:2:32767,1);% q0=data(2:2:32768,1);% q0=data(32769:2:65535,1);% i0=data(32770:2:65536,1);% i0=data(1:2:16383,1);% q0=data(2:2:16384,1);% i0=itemp(19:10000,1);% q0=qtemp(19:10000,1);q% i0(i0>2^31) = i0(i0>2^31)-2^32;% q0(q0>2^31) = q0(q0>2^31)-2^32;% Add windowiq_data = i0 +1i*q0 ;fft_iq_data = fftshift(fft(iq_data.*hanning(length(iq_data))))/(2^N_width-1);mag_fft_data = abs(fft_iq_data)*2/length(iq_data);f=(-fs/2:fs/length(mag_fft_data):fs/2-fs/length(mag_fft_data));fstart = 703e6;fstop = 748e6;deltaf = (fstop-fstart)/length(data)*2;fin = (fstart:deltaf:fstop-deltaf)';% Trans lin to dBdb_fft_data =20*log10(mag_fft_data);% db_fft_data =20*log10(mag_fft_data/max(mag_fft_data));% Plotfigure(1);plot(i0,'r'); hold on;grid on;plot(q0,'b');hold off;grid on;title('时序图');figure(2);plot(f,db_fft_data);grid on;title('频谱图');% 功率计算form_iq_data = iq_data/(2.^(N_width-1)-1); form_power_dbfs = 10*log10(sum(abs(form_iq_data).^2)/length(form_iq_data));fprintf('原始数据功率统计为%10.4f dbfs\n',form_power_dbfs);% NFFT = 2^nextpow2(length(iq_data));% Y = fftshift(fft(iq_data,NFFT)/length(iq_data));% [adat,addr] = max(Y);% fc = addr*fs/NFFT-fs/2; 